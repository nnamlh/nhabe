@model IEnumerable<MattanaSite.Models.get_detail_calendar_by_calendarid_Result>
@{
    ViewBag.Title = "ShowDetail";

    var calendar = ViewBag.CStaff as MattanaSite.Models.CalendarInfo;
}


<div class="portlet portlet-boxed">
    <div class="portlet-header">
        <h4 class="portlet-title">
            Chi tiết lịch &nbsp;&nbsp;&nbsp; <a href="javascript:remove('@calendar.Id')">Xóa lịch</a>
        </h4>
    </div> <!-- /.portlet-header -->

    <div class="portlet-body">

        <div class="row">
            <div class="col-sm-6">
                <div class="form-group">
                    <label>Thời gian</label>
                    <input type="text" class="form-control" value="@calendar.FDate.Value.ToString("dd/MM/yyyy") đến @calendar.TDate.Value.ToString("dd/MM/yyyy")" disabled />
                </div>
                <div class="form-group">
                    <label>Tuần thứ</label>
                    <input type="text" class="form-control" value="@calendar.WeekOfYear của năm @calendar.CYear" disabled />
                </div>
                <div class="form-group">
                    <label>Nội dung</label>
                    <input type="text" class="form-control" value="" disabled />
                </div>
                <div class="form-group">
                    <label>Ghi chú</label>
                    <input type="text" class="form-control" value="" disabled />
                </div>
              
            </div>

            <div class="col-sm-6">
                <label>Nhân viên</label>
                <table class="table table-striped table-bordered thumbnail-table">
                    @foreach (var item in calendar.MStaffs.ToList())
                    {
                        <tr>
                            <td>@item.Id</td>
                            <td>@item.FullName</td>
                        </tr>
                    }
                </table>
            </div>


            <div class="col-sm-12">
                <br />
                <a href="/calendar/ReportCalendarById?calendarId=@calendar.Id">Xuất lịch</a>
            </div>
            <div class="col-sm-12">
                <br />
                <table class="table table-striped table-bordered thumbnail-table">
                    <thead>
                        <tr>
                            <th>Ngày</th>
                            <th>Mã đại lý</th>
                            <th>Cửa hàng</th>
                            <th>Kế hoạch</th>
                            <th>Thực hiện</th>
                            <th>Thời gian</th>
                            <th>Nhân viên thực hiện</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{
                            int? temp = 0;
                        }
                        @foreach (var item in Model)
                        {
                            
                            
                            <tr>
                               <td>
                                    @if (temp != item.CDay)
                                    {
                                        temp = item.CDay;
                                        <span><strong>@item.DayInWeek, @item.CDay/@item.CMonth/@item.CYear</strong></span>
                                    }
                                </td>
                                <td>@item.Code</td>
                                <td>@item.Store</td>
                                <td>@(item.InPlan == 1?"Trong kế hoạch":"Ngoài kế hoạch")</td>
                                <td>@(item.Perform == 1?"Đã thực hiện":"Chưa thực hiện")</td>
                                <td>
                                    <span>Giờ vào thăm: </span>@(item.CInTime != null ? (new DateTime(item.CInTime.Value.Ticks).ToString("hh:mm")):"") <br />
                                    <span>Giờ ra: </span>@(item.COutTime != null ? (new DateTime(item.COutTime.Value.Ticks).ToString("hh:mm")) : "") 
                                </td>
                                <td>@item.StaffCheck - @item.StaffCheckName</td>
                            </tr>
                        }
                    </tbody>
                </table>

            </div>
        </div>

    </div>
</div>


<form method="post" action="/calendar/remove" id="formremove" onsubmit="if(!confirm('Xóa lịch?')){return false;}">
    <input type="hidden" name="id" id="calendarId" />
</form>

@section scripts {
    <script>
        function remove(id) {
            $('#calendarId').val(id);

            $('#formremove').submit();
        }
    </script>
}
